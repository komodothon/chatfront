{% extends "layout.html" %}

{% block title %}
Chat | {{ username }}
{% endblock %}

{% block content %}
<h2 class="py-4">Grazer Chat</h2>
<div class="container py-4">
  <div class="row">
    <div class="col-md-8">
      <!-- Message Input (at Top) -->
      <div class="input-group mb-3">
        <input id="message-input" type="text" class="form-control border rounded p-3" placeholder="Type a message..." style="border: 2px solid #007bff;">
        <button id="send-btn" class="btn btn-primary">Send</button>
      </div>

      <!-- Chat Box (column-reverse to show newest at top) -->
      <div id="chat-container" class="border rounded p-3 mb-3 bg-light" style="height: 600px; overflow-y: auto; display: flex; flex-direction: column; border: 2px solid #28a745;">
        <div id="chat-box" style="display: flex; flex-direction: column;"></div>
      </div>
    </div>
    
    
    <!-- Online Users & Logout -->
    <div class="col-md-4">
      <!-- Online Users -->
      <div class="card shadow-sm mb-3">
        <div class="card-header bg-primary text-white fw-semibold">
          <i class="bi bi-people-fill me-1"></i> Online Users
        </div>
        <ul class="list-group list-group-flush" id="online-users">
          <!-- Populated dynamically -->
        </ul>
      </div>

      <!-- Logout -->
      <div class="d-grid">
        <button id="logout-btn" class="btn btn-outline-danger">
          <i class="bi bi-box-arrow-right me-1"></i> Logout
        </button>
      </div>
    </div>
</div>
{% endblock %}

{% block scripts %}
<script>
  const CURRENT_USERNAME = "{{ username }}";
  const ws_token = "{{ ws_token }}";
</script>

<!-- Load external JS WebSocket client -->
<script src="{{ url_for('static', filename='js/ws_client.js') }}"></script>

{% endblock %}
